# ูุธุงู ุฅุฏุงุฑุฉ ุงูุฎุตุงุฆุต (Attributes System)

## ูุธุฑุฉ ุนุงูุฉ
ูุธุงู ุงูุฎุตุงุฆุต ูู ูุธุงู ูุฑู ููุชุทูุฑ ูุฅุฏุงุฑุฉ ุฎูุงุฑุงุช ุงูุชุฎุตูุต ููููุชุฌุงุช ูู ุงููุทุนู. ูุณูุญ ูููุณุคูููู ุจุฅูุดุงุก ุฎุตุงุฆุต ูุงุจูุฉ ูุฅุนุงุฏุฉ ุงูุงุณุชุฎุฏุงู ูุฑุจุทูุง ุจููุชุฌุงุช ูุฎุชููุฉ.

---

## ๐๏ธ ุงูุจููุฉ ุงูุฃุณุงุณูุฉ

### 1. ุฌุฏูู `attributes` (ุงูุฎุตุงุฆุต ุงูุฃุณุงุณูุฉ)
ูุญุชูู ุนูู ุชุนุฑูู ุงูุฎุงุตูุฉ ููุณูุง:

```sql
CREATE TABLE attributes (
  id UUID PRIMARY KEY,
  name_ar TEXT NOT NULL,           -- ุงุณู ุงูุฎุงุตูุฉ ุจุงูุนุฑุจูุฉ
  name_en TEXT NOT NULL,           -- ุงุณู ุงูุฎุงุตูุฉ ุจุงูุฅูุฌููุฒูุฉ
  description_ar TEXT,             -- ูุตู ุงูุฎุงุตูุฉ ุจุงูุนุฑุจูุฉ
  description_en TEXT,             -- ูุตู ุงูุฎุงุตูุฉ ุจุงูุฅูุฌููุฒูุฉ
  attribute_type TEXT NOT NULL,    -- ููุน ุงูุฎุงุตูุฉ (serving_type, sauce, bread, etc.)
  is_required BOOLEAN DEFAULT false,  -- ูู ุงูุฎุงุตูุฉ ุฅุฌุจุงุฑูุฉุ
  is_active BOOLEAN DEFAULT true,     -- ูู ุงูุฎุงุตูุฉ ูุดุทุฉุ
  sort_order INTEGER DEFAULT 0,       -- ุชุฑุชูุจ ุงูุนุฑุถ
  created_at TIMESTAMP,
  updated_at TIMESTAMP
);
```

**ุฃูุซูุฉ ุนูู ุงูุฎุตุงุฆุต:**
- ููุน ุงูุชูุฏูู (Serving Type): ุนุงุฏู / ุนุงุฆูู / ูุฑุฏู
- ููุน ุงูุตูุต (Sauce Type): ูุงุชุดุจ / ูุงููููุฒ / ุฎุฑุฏู
- ููุน ุงูุฎุจุฒ (Bread Type): ุฃุจูุถ / ุฃุณูุฑ / ุจุงูุณูุณู
- ุฏุฑุฌุฉ ุงูุญุฑุงุฑุฉ (Temperature): ุณุงุฎู / ุจุงุฑุฏ / ุฏุงูุฆ

---

### 2. ุฌุฏูู `attribute_options` (ุฎูุงุฑุงุช ุงูุฎุตุงุฆุต)
ูุญุชูู ุนูู ุงูุฎูุงุฑุงุช ุงููุชุงุญุฉ ููู ุฎุงุตูุฉ:

```sql
CREATE TABLE attribute_options (
  id UUID PRIMARY KEY,
  attribute_id UUID NOT NULL REFERENCES attributes(id),
  name_ar TEXT NOT NULL,           -- ุงุณู ุงูุฎูุงุฑ ุจุงูุนุฑุจูุฉ
  name_en TEXT NOT NULL,           -- ุงุณู ุงูุฎูุงุฑ ุจุงูุฅูุฌููุฒูุฉ
  price_adjustment NUMERIC DEFAULT 0,  -- ุงูุชุนุฏูู ุนูู ุงูุณุนุฑ (+5 ุฃู -3 ูุซูุงู)
  is_active BOOLEAN DEFAULT true,
  sort_order INTEGER DEFAULT 0,
  created_at TIMESTAMP,
  updated_at TIMESTAMP
);
```

**ูุซุงู:**
ููุฎุงุตูุฉ "ููุน ุงูุชูุฏูู":
- ุนุงุฏู (ุณุนุฑ ุนุงุฏู: 0)
- ุนุงุฆูู (+15 ุฌููู)
- ูุฑุฏู (-5 ุฌููู)

---

### 3. ุฌุฏูู `menu_item_attributes` (ุฑุจุท ุงูููุชุฌุงุช ุจุงูุฎุตุงุฆุต)
ูุฑุจุท ุงูููุชุฌุงุช ุจุงูุฎุตุงุฆุต ุงููุชุงุญุฉ ููุง:

```sql
CREATE TABLE menu_item_attributes (
  id UUID PRIMARY KEY,
  menu_item_id UUID NOT NULL REFERENCES menu_items(id),
  attribute_id UUID NOT NULL REFERENCES attributes(id),
  is_required_for_item BOOLEAN DEFAULT false,  -- ูู ุงูุฎุงุตูุฉ ุฅุฌุจุงุฑูุฉ ููุฐุง ุงูููุชุฌุ
  created_at TIMESTAMP
);
```

---

### 4. ุฌุฏูู `attribute_dependencies` (ุงูุชุจุนูุงุช ุจูู ุงูุฎูุงุฑุงุช)
ูุณูุญ ุจุฅูุดุงุก ุนูุงูุงุช ุชุจุนูุฉ ุจูู ุงูุฎูุงุฑุงุช (ููุฒุฉ ูุชูุฏูุฉ):

```sql
CREATE TABLE attribute_dependencies (
  id UUID PRIMARY KEY,
  parent_option_id UUID NOT NULL REFERENCES attribute_options(id),
  child_attribute_id UUID NOT NULL REFERENCES attributes(id),
  created_at TIMESTAMP
);
```

**ูุซุงู ุนูู ุงูุชุจุนูุฉ:**
- ุฅุฐุง ุงุฎุชุงุฑ ุงูุนููู "ุนุงุฆูู" ูู ููุน ุงูุชูุฏูู
- ูุธูุฑ ุชููุงุฆูุงู ุฎุงุตูุฉ "ุนุฏุฏ ุงูุตุญูู" (4 / 6 / 8)

---

## ๐ ููููุฉ ุงูุงุณุชุฎุฏุงู

### 1๏ธโฃ ุฅูุดุงุก ุฎุงุตูุฉ ุฌุฏูุฏุฉ
ูู ุตูุญุฉ "ุฅุฏุงุฑุฉ ุงูุฎุตุงุฆุต" (`/admin/attributes`):

1. ุงุถุบุท ุนูู "Add Attribute"
2. ุงููุฃ ุงููุนูููุงุช:
   - ุงูุงุณู ุจุงูุนุฑุจูุฉ ูุงูุฅูุฌููุฒูุฉ
   - ููุน ุงูุฎุงุตูุฉ (attribute_type)
   - ุงููุตู (ุงุฎุชูุงุฑู)
   - ูู ูู ุฅุฌุจุงุฑูุฉ ุจุดูู ุงูุชุฑุงุถูุ
3. ุงุถุบุท "Add"

---

### 2๏ธโฃ ุฅุถุงูุฉ ุฎูุงุฑุงุช ููุฎุงุตูุฉ
ุจุนุฏ ุฅูุดุงุก ุงูุฎุงุตูุฉ:

1. ุงุถุบุท ุนูู "Add Option" ุจุฌุงูุจ ุงูุฎุงุตูุฉ
2. ุงููุฃ ูุนูููุงุช ุงูุฎูุงุฑ:
   - ุงูุงุณู ุจุงูุนุฑุจูุฉ ูุงูุฅูุฌููุฒูุฉ
   - ุชุนุฏูู ุงูุณุนุฑ (ุงุฎุชูุงุฑู)
   - ุชุฑุชูุจ ุงูุนุฑุถ
3. ุงุถุบุท "Add"

**ูุซุงู:**
ุฎุงุตูุฉ: ููุน ุงูุตูุต
- ูุงุชุดุจ (+0 ุฌููู)
- ูุงููููุฒ (+2 ุฌููู)
- ุฎุฑุฏู (+1 ุฌููู)
- ุตูุต ุฎุงุต (+5 ุฌููู)

---

### 3๏ธโฃ ุฑุจุท ุงูุฎุตุงุฆุต ุจุงูููุชุฌุงุช
ูู ุตูุญุฉ "ุฅุฏุงุฑุฉ ุงูููุชุฌุงุช" (`/admin/products`):

1. ุนูุฏ ุฅุถุงูุฉ ุฃู ุชุนุฏูู ููุชุฌ
2. ุญุฏุฏ ุงูุฎุตุงุฆุต ุงููุชุงุญุฉ ููุฐุง ุงูููุชุฌ
3. ุญุฏุฏ ุฃู ูููุง ุฅุฌุจุงุฑูุฉ ููุฐุง ุงูููุชุฌ ุจุงูุฐุงุช

---

## ๐ฏ ุญุงูุงุช ุงูุงุณุชุฎุฏุงู

### ุญุงูุฉ 1: ุณุงูุฏููุชุด ุดุงูุฑูุง
**ุงูุฎุตุงุฆุต:**
- ููุน ุงูุฎุจุฒ (ุฅุฌุจุงุฑูุฉ): ุฃุจูุถ / ุฃุณูุฑ / ุฎุจุฒ ุชูุฑุชููุง
- ููุน ุงูุตูุต (ุฅุฌุจุงุฑูุฉ): ุซูู / ุทุญููุฉ / ุญุงุฑ
- ุฅุถุงูุงุช (ุงุฎุชูุงุฑูุฉ): ุจุทุงุทุณ (+5 ุฌููู) / ุฌุจู (+7 ุฌููู) / ุฎุถุงุฑ ุฅุถุงูู (+3 ุฌููู)

### ุญุงูุฉ 2: ุจูุชุฒุง
**ุงูุฎุตุงุฆุต:**
- ุงูุญุฌู (ุฅุฌุจุงุฑูุฉ): ุตุบูุฑ / ูุณุท / ูุจูุฑ / ุนุงุฆูู
- ุณูู ุงูุนุฌููุฉ (ุฅุฌุจุงุฑูุฉ): ุฑููุน / ุณููู / ูุญุดู
- ุฅุถุงูุงุช (ุงุฎุชูุงุฑูุฉ): ุฌุจู ุฅุถุงูู (+10 ุฌููู) / ุฒูุชูู (+5 ุฌููู) / ูููู ุญุงุฑ (ูุฌุงูู)

### ุญุงูุฉ 3: ูุดุฑูุจ
**ุงูุฎุตุงุฆุต:**
- ุงูุญุฌู (ุฅุฌุจุงุฑูุฉ): ุตุบูุฑ / ูุณุท / ูุจูุฑ
- ุฏุฑุฌุฉ ุงูุญุฑุงุฑุฉ (ุฅุฌุจุงุฑูุฉ): ุจุงุฑุฏ / ูุซูุฌ / ุฏุงูุฆ
- ุฅุถุงูุงุช (ุงุฎุชูุงุฑูุฉ): ุณูุฑ (+0) / ุจุฏูู ุณูุฑ (+0) / ุณูุฑ ุฏุงูุช (+2 ุฌููู)

---

## ๐ ุงูุชุฏูู ุงููุงูู

```
1. ุงููุณุคูู ููุดุฆ ุฎุงุตูุฉ "ููุน ุงูุชูุฏูู"
   โ
2. ูุถูู ุฎูุงุฑุงุช: ุนุงุฏู / ุนุงุฆูู / ูุฑุฏู
   โ
3. ูุฑุจุท ูุฐู ุงูุฎุงุตูุฉ ุจููุชุฌ "ุจุฑุฌุฑ ุงูุฏุฌุงุฌ"
   โ
4. ูุญุฏุฏ ุฃู ูุฐู ุงูุฎุงุตูุฉ ุฅุฌุจุงุฑูุฉ
   โ
5. ุงูุนููู ูุทูุจ "ุจุฑุฌุฑ ุงูุฏุฌุงุฌ"
   โ
6. ูุธูุฑ ูู ุงุฎุชูุงุฑ "ููุน ุงูุชูุฏูู"
   โ
7. ูุฎุชุงุฑ "ุนุงุฆูู" (ุงูุณุนุฑ ูุฒูุฏ ุจููุฏุงุฑ +15 ุฌููู)
   โ
8. ููุถุงู ุงูููุชุฌ ููุณูุฉ ุจุงูุณุนุฑ ุงููุนุฏูู
```

---

## โจ ุงููููุฒุงุช ุงูุฑุฆูุณูุฉ

### 1. ุงููุฑููุฉ ุงููุงููุฉ
- ูููู ุฅูุดุงุก ุฃู ููุน ูู ุงูุฎุตุงุฆุต
- ููุณ ููุงู ูููุฏ ุนูู ุนุฏุฏ ุงูุฎุตุงุฆุต ุฃู ุงูุฎูุงุฑุงุช
- ูููู ุงุณุชุฎุฏุงู ููุณ ุงูุฎุงุตูุฉ ูููุชุฌุงุช ูุฎุชููุฉ

### 2. ุฅุฏุงุฑุฉ ุงูุฃุณุนุงุฑ ุงูุฐููุฉ
- ุชุญุฏูุฏ ุชุฃุซูุฑ ูู ุฎูุงุฑ ุนูู ุงูุณุนุฑ ุงูููุงุฆู
- ูููู ุฒูุงุฏุฉ ุฃู ุชูููู ุงูุณุนุฑ
- ุญุณุงุจ ุชููุงุฆู ููุณุนุฑ ุงูุฅุฌูุงูู

### 3. ุชุนุฏุฏ ุงููุบุงุช
- ุฏุนู ูุงูู ููุนุฑุจูุฉ ูุงูุฅูุฌููุฒูุฉ
- ุฌููุน ุงูุฎุตุงุฆุต ูุงูุฎูุงุฑุงุช ูุชุนุฏุฏุฉ ุงููุบุงุช

### 4. ุงูุชุจุนูุงุช ุงููุชูุฏูุฉ
- ุฅููุงููุฉ ุฅุธูุงุฑ ุฎุตุงุฆุต ุจูุงุกู ุนูู ุฎูุงุฑุงุช ุฃุฎุฑู
- ูุซุงู: ุนูุฏ ุงุฎุชูุงุฑ "ุญุฌู ุนุงุฆูู" ุชุธูุฑ "ุนุฏุฏ ุงูุตุญูู"

---

## ๐๏ธ ุฅุฏุงุฑุฉ ุงูุฎุตุงุฆุต

### ุชูุนูู/ุชุนุทูู
- ูููู ุชุนุทูู ุฃู ุฎุงุตูุฉ ูุคูุชุงู ุฏูู ุญุฐููุง
- ุงูุฎุตุงุฆุต ุงููุนุทูุฉ ูุง ุชุธูุฑ ููุนููุงุก

### ุงูุชุฑุชูุจ
- ูููู ุงูุชุญูู ูู ุชุฑุชูุจ ุธููุฑ ุงูุฎุตุงุฆุต
- ูููู ุงูุชุญูู ูู ุชุฑุชูุจ ุงูุฎูุงุฑุงุช ุฏุงุฎู ูู ุฎุงุตูุฉ

### ุงูุชุนุฏูู ูุงูุญุฐู
- ูููู ุชุนุฏูู ุฃู ุฎุงุตูุฉ ุฃู ุฎูุงุฑ ูู ุฃู ููุช
- ุญุฐู ุงูุฎุงุตูุฉ ุณูุญุฐู ุฌููุน ุฎูุงุฑุงุชูุง

---

## ๐ ูุงุนุฏุฉ ุงูุจูุงูุงุช - ุงูุนูุงูุงุช

```
attributes (ุงูุฎุตุงุฆุต)
    โ has many
attribute_options (ุงูุฎูุงุฑุงุช)
    โ
menu_item_attributes (ุงูุฑุจุท)
    โ links
menu_items (ุงูููุชุฌุงุช)
```

---

## ๐จ ูุงุฌูุฉ ุงููุณุชุฎุฏู

### ูููุณุคูู (Admin Panel)
- ุตูุญุฉ ูุฎุตุตุฉ ูุฅุฏุงุฑุฉ ุงูุฎุตุงุฆุต (`/admin/attributes`)
- ูุงุฌูุฉ ุจุณูุทุฉ ูุฅุถุงูุฉ ูุชุนุฏูู ุงูุฎุตุงุฆุต
- ุนุฑุถ ุฌููุน ุงูุฎุตุงุฆุต ูุน ุฎูุงุฑุงุชูุง

### ููุนููู (Customer View)
- ุนูุฏ ุงุฎุชูุงุฑ ููุชุฌุ ุชุธูุฑ ุงูุฎุตุงุฆุต ุงููุชุงุญุฉ
- ูุงุฌูุฉ ุชูุงุนููุฉ ูุงุฎุชูุงุฑ ุงูุฎูุงุฑุงุช
- ุนุฑุถ ุชููุงุฆู ููุณุนุฑ ุงููุนุฏูู

---

## ๐ ููุงุญุธุงุช ุงูุฃูุงู

- ุฌููุน ุงูุฌุฏุงูู ูุญููุฉ ุจู RLS (Row Level Security)
- ุงูุชุนุฏููุงุช ูุชุงุญุฉ ูููุณุคูููู ููุท
- ุงููุฑุงุกุฉ ูุชุงุญุฉ ููุฌููุน

---

## ๐ ุฃูุซูุฉ ุนูู ุงูุงุณุชุนูุงูุงุช

### ุฌูุจ ุฎุตุงุฆุต ููุชุฌ ูุนูู:
```sql
SELECT 
  a.name_ar, 
  a.name_en,
  ao.name_ar as option_ar,
  ao.name_en as option_en,
  ao.price_adjustment
FROM menu_item_attributes mia
JOIN attributes a ON mia.attribute_id = a.id
JOIN attribute_options ao ON ao.attribute_id = a.id
WHERE mia.menu_item_id = 'product-id-here'
  AND a.is_active = true
  AND ao.is_active = true
ORDER BY a.sort_order, ao.sort_order;
```

---

## ๐ ุงูุฎุทูุงุช ุงูุชุงููุฉ ููุชุทููุฑ

1. โ ุฅูุดุงุก ุงูุฌุฏุงูู ุงูุฃุณุงุณูุฉ
2. โ ุจูุงุก ูุงุฌูุฉ ุงูุฅุฏุงุฑุฉ
3. โณ ุฑุจุท ุงูุฎุตุงุฆุต ุจุงูููุชุฌุงุช ูู ุงูููุฏ
4. โณ ุนุฑุถ ุงูุฎุตุงุฆุต ููุนููุงุก
5. โณ ุญุณุงุจ ุงูุฃุณุนุงุฑ ุชููุงุฆูุงู
6. โณ ุฏุนู ุงูุชุจุนูุงุช ุงููุชูุฏูุฉ

---

## ๐ก ูุตุงุฆุญ ููุงุณุชุฎุฏุงู ุงูุฃูุซู

1. **ุงูุชุณููุฉ ุงููุงุถุญุฉ**: ุงุณุชุฎุฏู ุฃุณูุงุก ูุงุถุญุฉ ููุนุจุฑุฉ ููุฎุตุงุฆุต
2. **ุงูุชูุธูู**: ุงุณุชุฎุฏู `attribute_type` ูุชุฌููุน ุงูุฎุตุงุฆุต ุงููุชุดุงุจูุฉ
3. **ุงูุชุฑุชูุจ ุงูููุทูู**: ุฑุชุจ ุงูุฎุตุงุฆุต ุญุณุจ ุฃูููุชูุง
4. **ุงูุฃุณุนุงุฑ ุงูุฏูููุฉ**: ุชุฃูุฏ ูู ุฏูุฉ ุชุนุฏููุงุช ุงูุฃุณุนุงุฑ
5. **ุงูุงุฎุชุจุงุฑ**: ุงุฎุชุจุฑ ุงูุฎุตุงุฆุต ูุจู ุชูุนูููุง ููุนููุงุก

---

## ๐ ุญู ุงููุดุงูู ุงูุดุงุฆุนุฉ

### ุงููุดููุฉ: ุงูุฎุงุตูุฉ ูุง ุชุธูุฑ ููุนููู
**ุงูุญู:** ุชุฃูุฏ ูู:
- ุงูุฎุงุตูุฉ ููุนููุฉ (`is_active = true`)
- ุงูุฎุงุตูุฉ ูุฑุจูุทุฉ ุจุงูููุชุฌ ูู `menu_item_attributes`
- ุงูุฎูุงุฑุงุช ุงููุชุงุญุฉ ููุนููุฉ

### ุงููุดููุฉ: ุงูุณุนุฑ ูุง ูุชุญุฏุซ ุจุดูู ุตุญูุญ
**ุงูุญู:** ุชุญูู ูู:
- `price_adjustment` ูู ุฌุฏูู `attribute_options`
- ุงูููุฏ ูุญุณุจ ุงูุณุนุฑ ุงูุฅุฌูุงูู ุจุดูู ุตุญูุญ

---

## ๐ ุงูุฏุนู ุงูููู

ุฅุฐุง ูุงู ูุฏูู ุฃู ุงุณุชูุณุงุฑุงุช ุฃู ุชุญุชุงุฌ ูุณุงุนุฏุฉ ูู ุงุณุชุฎุฏุงู ุงููุธุงูุ ููููู:
- ูุฑุงุฌุนุฉ ูุฐุง ุงูุฏููู
- ูุญุต ุงูููุฏ ูู `src/pages/admin/AttributeManagement.tsx`
- ูุฑุงุฌุนุฉ ุงูู hooks ูู `src/hooks/useDynamicAttributes.ts`

---

**ุขุฎุฑ ุชุญุฏูุซ:** 2025-10-01
**ุงูุฅุตุฏุงุฑ:** 1.0
